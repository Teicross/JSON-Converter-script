<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>EXCEL TO JSON CONVERTER</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Teicross/JSON-Converter-script@main/jsoncon-tei.css">
 <script src="https://cdn.jsdelivr.net/gh/Teicross/JSON-Converter-script@main/jsoncon-tei.js"></script>
</head>
<body>
  <!-- Header -->
  <div class="page-header sticky-top">
    <div class="container">
      <h1 class="h3 mb-1">JSON Structure Viewer</h1>
      <p class="mb-0">แปลงและแสดงโครงสร้าง JSON</p>
    </div>
  </div>
  <!-- Back to top -->
  <button id="backToTop" class="btn btn-dark d-flex align-items-center justify-content-center">
    ↑
  </button>
  <!-- Main Content -->
  <div class="container pb-5">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        
        <!-- Input Section -->
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body p-4">
            
            <!-- File Upload -->
            <div class="mb-4">
              <label class="form-label section-title">อัพโหลดไฟล์ Excel</label>
              <input type="file" id="input-excel" accept=".xlsx" class="form-control" />
              <div class="form-text">รองรับไฟล์ .xlsx เท่านั้น</div>
            </div>

            <div class="text-center my-3">
              <span class="badge bg-light text-muted">หรือ</span>
            </div>

            <!-- JSON Input -->
            <div class="mb-4">
              <label class="form-label section-title">ใส่ JSON</label>
              <textarea 
                id="json-input" 
                class="form-control font-monospace" 
                rows="8" 
                placeholder='{"name": "John", "age": 30, "city": "Bangkok"}'
              ></textarea>
              <div class="form-text">วาง JSON format ที่ต้องการแปลงเป็น Tree</div>
            </div>

            <!-- Action Buttons -->
            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
            <!-- <button id="parse-json" class="btn btn-primary">
                <i class="bi bi-diagram-3"></i> แปลงเป็น Tree
              </button>
            -->
              <button id="download-json" class="btn btn-primary" style="display: none;">
                <i class="bi bi-download"></i> ดาวน์โหลด JSON
              </button>
              <button id="copy-json" class="btn btn-outline-success" style="display: none;">
                <i class="bi bi-clipboard"></i> คัดลอก JSON
              </button>
            </div>
          </div>
        </div>

        <!-- Statistics -->
        <div id="stats-container" style="display: none;">
          <div class="card border-0 shadow-sm mb-4">
            <div class="card-body p-4">
              <div class="collapse-header" data-bs-toggle="collapse" data-bs-target="#statsCollapse" aria-expanded="true">
                <h6 class="section-title mb-0">สถิติข้อมูล</h6>
                <span class="collapse-icon">▼</span>
              </div>
              <div class="collapse show collapsible-content" id="statsCollapse">
                <div class="row g-3" id="stats-grid"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tree View -->
        <div id="tree-view" style="display: none;">
          <div class="card border-0 shadow-sm mb-4">
            <div class="card-body p-4">
              <div class="collapse-header" data-bs-toggle="collapse" data-bs-target="#treeCollapse" aria-expanded="true">
                <h6 class="section-title mb-0">โครงสร้าง Tree</h6>
                <span class="collapse-icon">▼</span>
              </div>
              <div class="collapse show collapsible-content" id="treeCollapse">
                <div class="tree-container">
                  <div id="tree-content" class="simple-tree"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- JSON Output -->
        <div id="json-output" style="display: none;">
          <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
              <div class="collapse-header" data-bs-toggle="collapse" data-bs-target="#jsonCollapse" aria-expanded="true">
                <h6 class="section-title mb-0">JSON Data</h6>
                <span class="collapse-icon">▼</span>
              </div>
              <div class="collapse show collapsible-content" id="jsonCollapse">
                <div class="bg-light border rounded p-3" style="max-height: 400px; overflow-y: auto;">
                  <pre id="output" class="mb-0"></pre>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container">
    <div id="toast" class="toast align-items-center border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="toast-message">
          คัดลอก JSON สำเร็จ!
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
      </div>
    </div>
  </div>
</body>
</html>
